



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="自然语言处理文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>Fileuploads - Flask Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#uploading-files" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Flask Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Flask Docs
            </span>
            <span class="md-header-nav__topic">
              Fileuploads
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/wohugb/nlp-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nlp-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="欢迎来到 Flask" class="md-tabs__link">
        欢迎来到 Flask
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../deploying/" title="Deploying" class="md-tabs__link">
          Deploying
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Patterns" class="md-tabs__link md-tabs__link--active">
          Patterns
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Tutorial" class="md-tabs__link">
          Tutorial
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Flask Docs" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Flask Docs
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/wohugb/nlp-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    nlp-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="欢迎来到 Flask" class="md-nav__link">
      欢迎来到 Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../10.foreword/" title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../11.advanced_foreword/" title="有经验的程序员的前言" class="md-nav__link">
      有经验的程序员的前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../12.installation/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../13.quickstart/" title="Quickstart" class="md-nav__link">
      Quickstart
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../15.templating/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../appcontext/" title="Appcontext" class="md-nav__link">
      Appcontext
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../becomingbig/" title="Becoming Big" class="md-nav__link">
      Becoming Big
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../blueprints/" title="Modular Applications with Blueprints" class="md-nav__link">
      Modular Applications with Blueprints
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../cli/" title="Cli" class="md-nav__link">
      Cli
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../config/" title="Configuration Handling" class="md-nav__link">
      Configuration Handling
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../design/" title="Design Decisions in Flask" class="md-nav__link">
      Design Decisions in Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../errorhandling/" title="Application Errors" class="md-nav__link">
      Application Errors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../extensiondev/" title="Flask Extension Development" class="md-nav__link">
      Flask Extension Development
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../extensions/" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../htmlfaq/" title="HTML/XHTML FAQ" class="md-nav__link">
      HTML/XHTML FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../latexindex/" title="Latexindex" class="md-nav__link">
      Latexindex
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../reqcontext/" title="Reqcontext" class="md-nav__link">
      Reqcontext
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../security/" title="Security Considerations" class="md-nav__link">
      Security Considerations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../server/" title="Development Server" class="md-nav__link">
      Development Server
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../shell/" title="Working with the Shell" class="md-nav__link">
      Working with the Shell
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../signals/" title="Signals" class="md-nav__link">
      Signals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../styleguide/" title="Pocoo Styleguide" class="md-nav__link">
      Pocoo Styleguide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../testing/" title="Testing Flask Applications" class="md-nav__link">
      Testing Flask Applications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../unicode/" title="Unicode in Flask" class="md-nav__link">
      Unicode in Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../upgrading/" title="Upgrading to Newer Releases" class="md-nav__link">
      Upgrading to Newer Releases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../views/" title="Pluggable Views" class="md-nav__link">
      Pluggable Views
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33" type="checkbox" id="nav-33">
    
    <label class="md-nav__link" for="nav-33">
      Deploying
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-33">
        Deploying
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/cgi/" title="CGI" class="md-nav__link">
      CGI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/fastcgi/" title="Fastcgi" class="md-nav__link">
      Fastcgi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/mod_wsgi/" title="Mod wsgi" class="md-nav__link">
      Mod wsgi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/uwsgi/" title="Uwsgi" class="md-nav__link">
      Uwsgi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/wsgi-standalone/" title="Wsgi standalone" class="md-nav__link">
      Wsgi standalone
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34" type="checkbox" id="nav-34" checked>
    
    <label class="md-nav__link" for="nav-34">
      Patterns
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-34">
        Patterns
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apierrors/" title="Implementing API Exceptions" class="md-nav__link">
      Implementing API Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appdispatch/" title="Appdispatch" class="md-nav__link">
      Appdispatch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appfactories/" title="Appfactories" class="md-nav__link">
      Appfactories
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../caching/" title="Caching" class="md-nav__link">
      Caching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../celery/" title="Celery Background Tasks" class="md-nav__link">
      Celery Background Tasks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deferredcallbacks/" title="Deferredcallbacks" class="md-nav__link">
      Deferredcallbacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../distribute/" title="Distribute" class="md-nav__link">
      Distribute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../errorpages/" title="Errorpages" class="md-nav__link">
      Errorpages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fabric/" title="Fabric" class="md-nav__link">
      Fabric
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../favicon/" title="Adding a favicon" class="md-nav__link">
      Adding a favicon
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Fileuploads
      </label>
    
    <a href="./" title="Fileuploads" class="md-nav__link md-nav__link--active">
      Fileuploads
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-gentle-introduction" title="A Gentle Introduction" class="md-nav__link">
    A Gentle Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#improving-uploads" title="Improving Uploads" class="md-nav__link">
    Improving Uploads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upload-progress-bars" title="Upload Progress Bars" class="md-nav__link">
    Upload Progress Bars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-easier-solution" title="An Easier Solution" class="md-nav__link">
    An Easier Solution
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../flashing/" title="Flashing" class="md-nav__link">
      Flashing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../jquery/" title="AJAX with jQuery" class="md-nav__link">
      AJAX with jQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lazyloading/" title="Lazily Loading Views" class="md-nav__link">
      Lazily Loading Views
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../methodoverrides/" title="Adding HTTP Method Overrides" class="md-nav__link">
      Adding HTTP Method Overrides
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mongoengine/" title="MongoDB with MongoEngine" class="md-nav__link">
      MongoDB with MongoEngine
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mongokit/" title="Mongokit" class="md-nav__link">
      Mongokit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../packages/" title="Packages" class="md-nav__link">
      Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../requestchecksum/" title="Request Content Checksums" class="md-nav__link">
      Request Content Checksums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../singlepageapplications/" title="Single-Page Applications" class="md-nav__link">
      Single-Page Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sqlalchemy/" title="Sqlalchemy" class="md-nav__link">
      Sqlalchemy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sqlite3/" title="Sqlite3" class="md-nav__link">
      Sqlite3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../streaming/" title="Streaming Contents" class="md-nav__link">
      Streaming Contents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../subclassing/" title="Subclassing Flask" class="md-nav__link">
      Subclassing Flask
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../templateinheritance/" title="Templateinheritance" class="md-nav__link">
      Templateinheritance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../urlprocessors/" title="Using URL Processors" class="md-nav__link">
      Using URL Processors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viewdecorators/" title="View Decorators" class="md-nav__link">
      View Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wtforms/" title="Form Validation with WTForms" class="md-nav__link">
      Form Validation with WTForms
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-35" type="checkbox" id="nav-35">
    
    <label class="md-nav__link" for="nav-35">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-35">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/blog/" title="Blog" class="md-nav__link">
      Blog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/database/" title="Database" class="md-nav__link">
      Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/deploy/" title="Deploy to Production" class="md-nav__link">
      Deploy to Production
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/factory/" title="Factory" class="md-nav__link">
      Factory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/install/" title="Make the Project Installable" class="md-nav__link">
      Make the Project Installable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/layout/" title="Project Layout" class="md-nav__link">
      Project Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/next/" title="Keep Developing!" class="md-nav__link">
      Keep Developing!
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/static/" title="Static Files" class="md-nav__link">
      Static Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tests/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/views/" title="Views" class="md-nav__link">
      Views
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-gentle-introduction" title="A Gentle Introduction" class="md-nav__link">
    A Gentle Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#improving-uploads" title="Improving Uploads" class="md-nav__link">
    Improving Uploads
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upload-progress-bars" title="Upload Progress Bars" class="md-nav__link">
    Upload Progress Bars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-easier-solution" title="An Easier Solution" class="md-nav__link">
    An Easier Solution
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p>.. _uploading-files:</p>
<h1 id="uploading-files">Uploading Files<a class="headerlink" href="#uploading-files" title="Permanent link">&para;</a></h1>
<p>Ah yes, the good old problem of file uploads. The basic idea of file
uploads is actually quite simple. It basically works like this:</p>
<ol>
<li>A <code>&lt;form&gt;</code> tag is marked with <code>enctype=multipart/form-data</code>
   and an <code>&lt;input type=file&gt;</code> is placed in that form.</li>
<li>The application accesses the file from the :attr:<code>~flask.request.files</code>
   dictionary on the request object.</li>
<li>use the :meth:<code>~werkzeug.datastructures.FileStorage.save</code> method of the file to save
   the file permanently somewhere on the filesystem.</li>
</ol>
<h2 id="a-gentle-introduction">A Gentle Introduction<a class="headerlink" href="#a-gentle-introduction" title="Permanent link">&para;</a></h2>
<p>Let's start with a very basic application that uploads a file to a
specific upload folder and displays a file to the user. Let's look at the
bootstrapping code for our application::</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">flash</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>
<span class="kn">from</span> <span class="nn">werkzeug.utils</span> <span class="kn">import</span> <span class="n">secure_filename</span>

<span class="n">UPLOAD_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;/path/to/the/uploads&#39;</span>
<span class="n">ALLOWED_EXTENSIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="s1">&#39;jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;gif&#39;</span><span class="p">}</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UPLOAD_FOLDER</span>
</pre></div>


<p>So first we need a couple of imports. Most should be straightforward, the
:func:<code>werkzeug.secure_filename</code> is explained a little bit later. The
<code>UPLOAD_FOLDER</code> is where we will store the uploaded files and the
<code>ALLOWED_EXTENSIONS</code> is the set of allowed file extensions.</p>
<p>Why do we limit the extensions that are allowed? You probably don't want
your users to be able to upload everything there if the server is directly
sending out the data to the client. That way you can make sure that users
are not able to upload HTML files that would cause XSS problems (see
:ref:<code>xss</code>). Also make sure to disallow <code>.php</code> files if the server
executes them, but who has PHP installed on their server, right? :)</p>
<p>Next the functions that check if an extension is valid and that uploads
the file and redirects the user to the URL for the uploaded file::</p>
<div class="codehilite"><pre><span></span>def allowed_file(filename):
    return &#39;.&#39; in filename and \
           filename.rsplit(&#39;.&#39;, 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        # check if the post request has the file part
        if &#39;file&#39; not in request.files:
            flash(&#39;No file part&#39;)
            return redirect(request.url)
        file = request.files[&#39;file&#39;]
        # if user does not select file, browser also
        # submit an empty part without filename
        if file.filename == &#39;&#39;:
            flash(&#39;No selected file&#39;)
            return redirect(request.url)
        if file and allowed_file(file.filename):
            filename = secure_filename(file.filename)
            file.save(os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename))
            return redirect(url_for(&#39;uploaded_file&#39;,
                                    filename=filename))
    return &#39;&#39;&#39;
    &amp;lt;!doctype html&amp;gt;
    &amp;lt;title&amp;gt;Upload new File&amp;lt;/title&amp;gt;
    &amp;lt;h1&amp;gt;Upload new File&amp;lt;/h1&amp;gt;
    &amp;lt;form method=post enctype=multipart/form-data&amp;gt;
      &amp;lt;input type=file name=file&amp;gt;
      &amp;lt;input type=submit value=Upload&amp;gt;
    &amp;lt;/form&amp;gt;
    &#39;&#39;&#39;
</pre></div>


<p>So what does that :func:<code>~werkzeug.utils.secure_filename</code> function actually do?
Now the problem is that there is that principle called "never trust user
input". This is also true for the filename of an uploaded file. All
submitted form data can be forged, and filenames can be dangerous. For
the moment just remember: always use that function to secure a filename
before storing it directly on the filesystem.</p>
<p>.. admonition:: Information for the Pros</p>
<p>So you're interested in what that :func:<code>~werkzeug.utils.secure_filename</code>
function does and what the problem is if you're not using it? So just
imagine someone would send the following information as <code>filename</code> to
your application::</p>
<div class="codehilite"><pre><span></span>  filename = &quot;../../../../home/username/.bashrc&quot;
</pre></div>


<p>Assuming the number of <code>../</code> is correct and you would join this with
the <code>UPLOAD_FOLDER</code> the user might have the ability to modify a file on
the server's filesystem he or she should not modify. This does require some
knowledge about how the application looks like, but trust me, hackers
are patient :)</p>
<p>Now let's look how that function works:</p>
<blockquote>
<blockquote>
<blockquote>
<p>secure<em>filename('../../../../home/username/.bashrc')
'home_username</em>.bashrc'</p>
</blockquote>
</blockquote>
</blockquote>
<p>Now one last thing is missing: the serving of the uploaded files. In the
:func:<code>upload_file()</code> we redirect the user to
<code>url_for('uploaded_file', filename=filename)</code>, that is, <code>/uploads/filename</code>.
So we write the :func:<code>uploaded_file</code> function to return the file of that name. As
of Flask 0.5 we can use a function that does that for us::</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">send_from_directory</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/uploads/&amp;lt;filename&amp;gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">uploaded_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span>
                               <span class="n">filename</span><span class="p">)</span>
</pre></div>


<p>Alternatively you can register <code>uploaded_file</code> as <code>build_only</code> rule and
use the :class:<code>~werkzeug.wsgi.SharedDataMiddleware</code>. This also works with
older versions of Flask::</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">werkzeug</span> <span class="kn">import</span> <span class="n">SharedDataMiddleware</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s1">&#39;/uploads/&amp;lt;filename&amp;gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;uploaded_file&#39;</span><span class="p">,</span>
                 <span class="n">build_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">SharedDataMiddleware</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;/uploads&#39;</span><span class="p">:</span>  <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>


<p>If you now run the application everything should work as expected.</p>
<h2 id="improving-uploads">Improving Uploads<a class="headerlink" href="#improving-uploads" title="Permanent link">&para;</a></h2>
<p>.. versionadded:: 0.6</p>
<p>So how exactly does Flask handle uploads? Well it will store them in the
webserver's memory if the files are reasonable small otherwise in a
temporary location (as returned by :func:<code>tempfile.gettempdir</code>). But how
do you specify the maximum file size after which an upload is aborted? By
default Flask will happily accept file uploads to an unlimited amount of
memory, but you can limit that by setting the <code>MAX_CONTENT_LENGTH</code>
config key::</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;MAX_CONTENT_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
</pre></div>


<p>The code above will limit the maximum allowed payload to 16 megabytes.
If a larger file is transmitted, Flask will raise a
:exc:<code>~werkzeug.exceptions.RequestEntityTooLarge</code> exception.</p>
<p>.. admonition:: Connection Reset Issue</p>
<div class="codehilite"><pre><span></span>When using the local development server, you may get a connection
reset error instead of a 413 response. You will get the correct
status response when running the app with a production WSGI server.
</pre></div>


<p>This feature was added in Flask 0.6 but can be achieved in older versions
as well by subclassing the request object. For more information on that
consult the Werkzeug documentation on file handling.</p>
<h2 id="upload-progress-bars">Upload Progress Bars<a class="headerlink" href="#upload-progress-bars" title="Permanent link">&para;</a></h2>
<p>A while ago many developers had the idea to read the incoming file in
small chunks and store the upload progress in the database to be able to
poll the progress with JavaScript from the client. Long story short: the
client asks the server every 5 seconds how much it has transmitted
already. Do you realize the irony? The client is asking for something it
should already know.</p>
<h2 id="an-easier-solution">An Easier Solution<a class="headerlink" href="#an-easier-solution" title="Permanent link">&para;</a></h2>
<p>Now there are better solutions that work faster and are more reliable. There
are JavaScript libraries like jQuery_ that have form plugins to ease the
construction of progress bar.</p>
<p>Because the common pattern for file uploads exists almost unchanged in all
applications dealing with uploads, there is also a Flask extension called
<code>Flask-Uploads</code>_ that implements a full fledged upload mechanism with white and
blacklisting of extensions and more.</p>
<p>.. _jQuery: https://jquery.com/
.. _Flask-Uploads: https://pythonhosted.org/Flask-Uploads/</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../favicon/" title="Adding a favicon" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                Adding a favicon
              </span>
            </div>
          </a>
        
        
          <a href="../flashing/" title="Flashing" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                Flashing
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            @2018 nlp-docs.github.io
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.2ba8dec4.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>